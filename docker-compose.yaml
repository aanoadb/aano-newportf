version: '3.8'

services:
  portfolio:
    build: .
    container_name: portfolio-website
    ports:
      - "8080:80"      # HTTP untuk Cloudflare
      - "8443:443"     # HTTPS direct (optional)
    environment:
      - TZ=Asia/Jakarta
    volumes:
      # Gunakan volume untuk static files jika perlu
      - ./logs:/var/log/nginx
      # Jika mau hot-reload file tanpa rebuild:
      # - ./index.html:/usr/share/nginx/html/index.html:ro
      # - ./style.css:/usr/share/nginx/html/style.css:ro
      # - ./script.js:/usr/share/nginx/html/script.js:ro
      # - ./src/img:/usr/share/nginx/html/src/img:ro
    networks:
      - portfolio-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

networks:
  portfolio-network:
    driver: bridge